<!DOCTYPE html>
<html>
<head>
<title>Help Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="firebase.js"></script>

<style>
body{
    font-family:Arial;
    background:#f4f4f4;
    margin:0;padding:0;
}
.header{
    background:#222;
    color:white;
    padding:15px;
    text-align:center;
    font-size:22px;
    font-weight:bold;
}
.card{
    background:white;
    padding:15px;
    margin:10px;
    border-radius:10px;
    box-shadow:0 0 10px #ccc;
}
.btn{
    background:#ff1493;
    color:white;
    padding:8px 12px;
    border:none;
    border-radius:6px;
    cursor:pointer;
}
.input{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid #aaa;
    margin-top:10px;
}
</style>

</head>
<body>

<div class="header">Help & Support â€“ Admin Panel</div>

<div id="list"></div>

<script>
// ðŸ›‘ ADMIN LOGIN PROTECTION (Admin UID here)
const ADMIN_UID = "ADMIN_FIREBASE_UID_HERE";

auth.onAuthStateChanged(user=>{
    if(!user || user.uid !== ADMIN_UID){
        alert("Access Denied!");
        return window.location="login.html";
    }
    loadSupport();
});

function loadSupport(){
    db.collection("support")
      .orderBy("time","desc")
      .onSnapshot(snap=>{
        let list=document.getElementById("list");
        list.innerHTML="";

        snap.forEach(doc=>{
            let d=doc.data();
            list.innerHTML += `
            <div class="card">
                <b>User ID:</b> ${d.uid}<br><br>
                <b>Issue:</b><br>${d.message}<br><br>

                <b>Admin Reply:</b><br>
                <textarea id="reply_${doc.id}" class="input" placeholder="Type reply...">${d.adminReply || ""}</textarea>
                <br>

                <button class="btn" onclick="sendReply('${doc.id}')">Send Reply</button>
            </div>
            `;
        });
      });
}

function sendReply(id){
    let reply=document.getElementById("reply_"+id).value.trim();

    db.collection("support").doc(id).update({
        adminReply: reply,
        status: "replied"
    });

    alert("Reply sent!");
}
</script>

</body>
</html>

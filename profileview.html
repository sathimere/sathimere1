<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Profile View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<style>
body{
  margin:0;
  font-family:'Poppins',Arial;
  background:#f7f7f7;
}

.header{
  width:100%;
  background:#ff4da6;
  padding:18px 0;
  text-align:center;
  color:white;
  font-size:22px;
  font-weight:600;
}

.topPhoto{
  width:160px;
  height:160px;
  border-radius:50%;
  object-fit:cover;
  border:4px solid white;
  margin-top:-80px;
}

.box{
  background:white;
  padding:18px;
  border-radius:14px;
  margin-top:20px;
  width:92%;
  margin-left:auto;
  margin-right:auto;
  box-shadow:0 2px 10px rgba(0,0,0,0.1);
}

.title{
  font-size:18px;
  font-weight:600;
  color:#ff4da6;
  margin-bottom:10px;
}

.item{
  font-size:15px;
  margin-bottom:6px;
}

.bold{
  font-weight:600;
}

.center{
  text-align:center;
  margin-top:10px;
}

</style>
</head>

<body>

<div class="header">Profile Details</div>

<div class="center">
  <img id="profileImg" class="topPhoto" src="https://i.imgur.com/3G0P4tJ.png">
</div>

<div class="box">
  <div class="title">Basic Information</div>
  <div class="item"><span class="bold">Name:</span> <span id="name"></span></div>
  <div class="item"><span class="bold">Surname:</span> <span id="surname"></span></div>
  <div class="item"><span class="bold">Age:</span> <span id="age"></span></div>
  <div class="item"><span class="bold">Gender:</span> <span id="gender"></span></div>
  <div class="item"><span class="bold">DOB:</span> <span id="dob"></span></div>
</div>

<div class="box">
  <div class="title">Family Details</div>
  <div class="item"><span class="bold">Father's Name:</span> <span id="father"></span></div>
  <div class="item"><span class="bold">Mother's Name:</span> <span id="mother"></span></div>
  <div class="item"><span class="bold">Caste:</span> <span id="caste"></span></div>
</div>

<div class="box">
  <div class="title">Location</div>
  <div class="item"><span class="bold">City:</span> <span id="city"></span></div>
  <div class="item"><span class="bold">District:</span> <span id="district"></span></div>
  <div class="item"><span class="bold">State:</span> <span id="state"></span></div>
  <div class="item"><span class="bold">Address:</span> <span id="address"></span></div>
</div>

<div class="box">
  <div class="title">Contact</div>
  <div class="item"><span class="bold">Email:</span> <span id="email"></span></div>
  <div class="item"><span class="bold">Mobile:</span> <span id="mobile"></span></div>
</div>

<div class="box">
  <div class="title">More Info</div>
  <div class="item"><span class="bold">Interest:</span> <span id="interest"></span></div>
  <div class="item"><span class="bold">Choice (Partner Preference):</span> <span id="choice"></span></div>
</div>

<script>
// --------------------
// FIREBASE CONFIG
// --------------------
const firebaseConfig = {
  apiKey: "AIzaSyCNujpIBIvJXMk34yQF1VeuTVFi5M7vdc0",
  authDomain: "sathimere-415fa.firebaseapp.com",
  projectId: "sathimere-415fa",
  storageBucket: "sathimere-415fa.firebasestorage.app",
  messagingSenderId: "290492321074",
  appId: "1:290492321074:web:05aa3d9abc2d3ab7635b2b"
};
firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();
const auth = firebase.auth();

// Auto login
auth.signInAnonymously();

// --------------------
// GET PROFILE ID FROM URL
// --------------------
const urlParams = new URLSearchParams(window.location.search);
const userId = urlParams.get("id");

// --------------------
// LOAD PROFILE DATA
// --------------------
auth.onAuthStateChanged(async ()=>{
    if(!userId) return;

    let snap = await db.collection("users").doc(userId).get();
    if(!snap.exists){
        alert("Profile not found!");
        return;
    }

    let d = snap.data();

    document.getElementById("profileImg").src = d.photo || "https://i.imgur.com/3G0P4tJ.png";
    document.getElementById("name").innerText = d.name || "";
    document.getElementById("surname").innerText = d.surname || "";
    document.getElementById("age").innerText = d.age || "";
    document.getElementById("dob").innerText = d.dob || "";
    document.getElementById("gender").innerText = d.gender || "";

    document.getElementById("father").innerText = d.fatherName || "";
    document.getElementById("mother").innerText = d.motherName || "";
    document.getElementById("caste").innerText = d.caste || "";

    document.getElementById("city").innerText = d.city || "";
    document.getElementById("district").innerText = d.district || "";
    document.getElementById("state").innerText = d.state || "";
    document.getElementById("address").innerText = d.address || "";

    document.getElementById("email").innerText = d.email || "";

    // Mobile privacy check
    if(d.mobilePrivacy === "private"){
        document.getElementById("mobile").innerText = "Private";
    } else {
        document.getElementById("mobile").innerText = d.mobile || "";
    }

    document.getElementById("interest").innerText = d.interest || "";
    document.getElementById("choice").innerText = d.choice || "";
});
</script>

</body>
</html>
